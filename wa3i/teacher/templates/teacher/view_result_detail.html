{% extends 'teacher/base.html' %}
{% load static %}

{% block content %}

<!-- Bootstrap core CSS -->
<link href="{% static 'mainpage/vendor/bootstrap/css/bootstrap.min.css' %}" rel="stylesheet">

<!-- Custom styles for this template -->
<link href="{% static 'mainpage/css/small-business.css' %}" rel="stylesheet">
<link href="{% static 'mainpage/css/speech-bubble.css' %}" rel="stylesheet">
<link href="{% static 'mainpage/css/basic.css' %}" rel="stylesheet">

<link rel="stylesheet" type="text/css" href="{% static 'teacher/css/main.css' %}">

<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css"
      integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">

<link href="{% static 'teacher/css/teacher.css' %}" rel="stylesheet">

<script>
    $(document).ready(function () {
        var abc = {};
        abc['aaa'] = 'bbb';
        $("#file_download").on("click", function (e) {
            $("a#download").attr({
                "download": "download.json",
                "href": "data:application/json;charset=utf8;base64," + window.btoa(JSON.stringify(abc))
            }).get(0).click();
        });
    });
</script>

<!-- Page Content -->
<div class="container">

    <!-- Heading Row -->
    <div class="row justify-content-center my-5">
        <div class="col-lg-2">
            <img class="img-fluid rounded mb-4 mb-lg-0" src="{% static 'mainpage/image/logo.png' %}" width="120"
                 height="120" alt="">
        </div>
        <!-- /.col-lg-8 -->
        <div class="col-lg-5">
            <!--            <h1 class="font-weight-light">결과보기</h1><br>-->
            <p class="font-weight-bolder triangle-border left">
                학생들의 응답 결과입니다.<br>
                응답 결과는 파일로도 저장이 가능합니다.</p>
            <!--        <a class="btn btn-primary" href="#">Call to Action!</a>-->
        </div>
        <!-- /.col-md-4 -->
    </div>
    <table border="1" bordercolor="gray" width="1200" height="100" align="center"
           class="table-center">
        <tr align="center" bgcolor="#2E4A62" class="table-tr">
            <td>제목</td>
            <td>타입</td>
            <td>코드</td>
            <td>기간</td>
            <td>학년</td>
            <td class="class-box-width">반</td>
            <td>문항수</td>
            <td>전체 평균점수</td>
            <td>평균 진행률(%)</td>
            <td>결과 저장</td>
            <td>더보기</td>
        </tr>
        {% for data in assignment_data|slice:":1" %}
        <tr align="center">
            <td>{{ data.assignment_title }}</td>
            <td>{{ data.type }}</td>
            <td>{{ data.assignment_id }}</td>
            <td>{{ data.start_date }} ~<br> {{ data.end_date }}</td>
            <td>{{ data.grade }}</td>
            <td>{{ data.school_class }}</td>
            <td>{{ question_count }}</td>
            <td>{{ all_avg }}</td>
            <td>{{ all_pgs }}</td>
            <td>
                <button class="btn21" id="file_download">다운로드</button>
                <a id="download" download="" href=""></a></td>
            <td>
                <button class="btn21">더보기</button>
            </td>
        </tr>
        {% endfor %}
    </table>

    <table border="1" bordercolor="gray" width="1200" height="100" align="center"
           class="table-center">
        <tr align="center" bgcolor="#2E4A62" class="table-tr">
            <td width="90">학생ID</td>
            <td width="70">학생이름</td>
            <td width="70">평균점수</td>
            <td width="80">진행률(%)</td>
            <td>학생응답</td>
        </tr>

        {% for data in result %}
        <tr align="center">
            <td>{{ data.student_id }}</td>
            <td>{{ data.student_name }}</td>
            <td>{{ data.student_score }}</td>
            <td>{{ data.student_progress}}</td>
            <td align="left" class="pad20">
                {% for i in data.student_response %}
                {{ i }}
                <br><br>
                {% endfor %}
            </td>
        </tr>
        {% endfor %}

    </table>

    <!-- /.row -->
    <div class="col-lg-0 btn-center">
        <form action="{% url 'view_result' %}">
            <button type="submit" class="w3-button w3-large w3-round w3-blue">이전</button>
        </form>
    </div>
</div>
<!-- /.container -->

<!-- Bootstrap core JavaScript -->
<script src="{% static 'mainpage/vendor/jquery/jquery.min.js' %}"></script>
<script src="{% static 'mainpage/vendor/bootstrap/js/bootstrap.bundle.min.js' %}"></script>

{% endblock %}
